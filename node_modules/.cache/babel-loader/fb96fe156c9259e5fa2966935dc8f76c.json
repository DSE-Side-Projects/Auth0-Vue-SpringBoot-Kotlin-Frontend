{"remainingRequest":"/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/node_modules/babel-loader/lib/index.js!/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/node_modules/eslint-loader/index.js??ref--13-0!/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/auth/authService.js","dependencies":[{"path":"/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/auth/authService.js","mtime":1591054823542},{"path":"/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL2VsbGVuY29ubGV5L3NkZS1wcm9qZWN0cy9hdXRoMC1ibG9nLXR1dG9yaWFscy9Nb3ZpZVJldmlld0JvYXJkL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2VsbGVuY29ubGV5L3NkZS1wcm9qZWN0cy9hdXRoMC1ibG9nLXR1dG9yaWFscy9Nb3ZpZVJldmlld0JvYXJkL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL2VsbGVuY29ubGV5L3NkZS1wcm9qZWN0cy9hdXRoMC1ibG9nLXR1dG9yaWFscy9Nb3ZpZVJldmlld0JvYXJkL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBhdXRoMCBmcm9tICJhdXRoMC1qcyI7CmltcG9ydCBhdXRoQ29uZmlnIGZyb20gIi4uL2F1dGhfY29uZmlnLmpzb24iOwppbXBvcnQgZXZlbnRCdXMgZnJvbSAiLi4vZXZlbnQtYnVzIjsKdmFyIHdlYkF1dGggPSBuZXcgYXV0aDAuV2ViQXV0aCh7CiAgZG9tYWluOiBhdXRoQ29uZmlnLmRvbWFpbiwKICByZWRpcmVjdFVyaTogIiIuY29uY2F0KHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sICIvY2FsbGJhY2siKSwKICBjbGllbnRJRDogYXV0aENvbmZpZy5jbGllbnRJZCwKICBhdWRpZW5jZTogYXV0aENvbmZpZy5hdWRpZW5jZSwKICByZXNwb25zZVR5cGU6ICJ0b2tlbiBpZF90b2tlbiIsCiAgc2NvcGU6ICJvcGVuaWQgcHJvZmlsZSBlbWFpbCIKfSk7Cgp2YXIgQXV0aFNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEF1dGhTZXJ2aWNlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1dGhTZXJ2aWNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImFjY2Vzc1Rva2VuIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJpZFRva2VuIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJwcm9maWxlIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJ0b2tlbkV4cGlyeSIsIG51bGwpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEF1dGhTZXJ2aWNlLCBbewogICAga2V5OiAibG9naW4iLAogICAgLy8gU3RhcnRzIHRoZSB1c2VyIGxvZ2luIGZsb3cKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2dpbihjdXN0b21TdGF0ZSkgewogICAgICB3ZWJBdXRoLmF1dGhvcml6ZSh7CiAgICAgICAgYXBwU3RhdGU6IGN1c3RvbVN0YXRlCiAgICAgIH0pOwogICAgfSAvLyBIYW5kbGVzIHRoZSBjYWxsYmFjayByZXF1ZXN0IGZyb20gQXV0aDAKCiAgfSwgewogICAga2V5OiAiaGFuZGxlQXV0aGVudGljYXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUF1dGhlbnRpY2F0aW9uKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB3ZWJBdXRoLnBhcnNlSGFzaChmdW5jdGlvbiAoZXJyLCBhdXRoUmVzdWx0KSB7CiAgICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgIHJlamVjdChlcnIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXMubG9jYWxMb2dpbihhdXRoUmVzdWx0KTsKCiAgICAgICAgICAgIHJlc29sdmUoYXV0aFJlc3VsdC5pZFRva2VuKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9jYWxMb2dpbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9jYWxMb2dpbihhdXRoUmVzdWx0KSB7CiAgICAgIHRoaXMuaWRUb2tlbiA9IGF1dGhSZXN1bHQuaWRUb2tlbjsKICAgICAgdGhpcy5wcm9maWxlID0gYXV0aFJlc3VsdC5pZFRva2VuUGF5bG9hZDsKICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGF1dGhSZXN1bHQuYWNjZXNzVG9rZW47IC8vIENvbnZlcnQgdGhlIEpXVCBleHBpcnkgdGltZSBmcm9tIHNlY29uZHMgdG8gbWlsbGlzZWNvbmRzCgogICAgICB0aGlzLnRva2VuRXhwaXJ5ID0gbmV3IERhdGUodGhpcy5wcm9maWxlLmV4cCAqIDEwMDApOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgibG9nZ2VkSW4iLCAidHJ1ZSIpOwogICAgICBldmVudEJ1cy4kZW1pdCgibG9naW4iKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBdXRoU2VydmljZTsKfSgpOwoKZXhwb3J0IGRlZmF1bHQgbmV3IEF1dGhTZXJ2aWNlKCk7"},{"version":3,"sources":["/Users/ellenconley/sde-projects/auth0-blog-tutorials/MovieReviewBoard/frontend/auth/authService.js"],"names":["auth0","authConfig","eventBus","webAuth","WebAuth","domain","redirectUri","window","location","origin","clientID","clientId","audience","responseType","scope","AuthService","customState","authorize","appState","Promise","resolve","reject","parseHash","err","authResult","localLogin","idToken","profile","idTokenPayload","accessToken","tokenExpiry","Date","exp","localStorage","setItem","$emit"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,UAAlB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,OAAOC,QAAP,MAAqB,cAArB;AAEA,IAAMC,OAAO,GAAG,IAAIH,KAAK,CAACI,OAAV,CAAkB;AAChCC,EAAAA,MAAM,EAAEJ,UAAU,CAACI,MADa;AAEhCC,EAAAA,WAAW,YAAKC,MAAM,CAACC,QAAP,CAAgBC,MAArB,cAFqB;AAGhCC,EAAAA,QAAQ,EAAET,UAAU,CAACU,QAHW;AAIhCC,EAAAA,QAAQ,EAAEX,UAAU,CAACW,QAJW;AAKhCC,EAAAA,YAAY,EAAE,gBALkB;AAMhCC,EAAAA,KAAK,EAAE;AANyB,CAAlB,CAAhB;;IASMC,W;;;;yCACU,I;;qCACJ,I;;qCACA,I;;yCACI,I;;;;;AACd;0BACMC,W,EAAa;AACjBb,MAAAA,OAAO,CAACc,SAAR,CAAkB;AAChBC,QAAAA,QAAQ,EAAEF;AADM,OAAlB;AAGD,K,CACD;;;;2CACuB;AAAA;;AACrB,aAAO,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtClB,QAAAA,OAAO,CAACmB,SAAR,CAAkB,UAACC,GAAD,EAAMC,UAAN,EAAqB;AACrC,cAAID,GAAJ,EAAS;AACPF,YAAAA,MAAM,CAACE,GAAD,CAAN;AACD,WAFD,MAEO;AACL,YAAA,KAAI,CAACE,UAAL,CAAgBD,UAAhB;;AACAJ,YAAAA,OAAO,CAACI,UAAU,CAACE,OAAZ,CAAP;AACD;AACF,SAPD;AAQD,OATM,CAAP;AAUD;;;+BACUF,U,EAAY;AACrB,WAAKE,OAAL,GAAeF,UAAU,CAACE,OAA1B;AACA,WAAKC,OAAL,GAAeH,UAAU,CAACI,cAA1B;AACA,WAAKC,WAAL,GAAmBL,UAAU,CAACK,WAA9B,CAHqB,CAIrB;;AACA,WAAKC,WAAL,GAAmB,IAAIC,IAAJ,CAAS,KAAKJ,OAAL,CAAaK,GAAb,GAAmB,IAA5B,CAAnB;AACAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiC,MAAjC;AACAhC,MAAAA,QAAQ,CAACiC,KAAT,CAAe,OAAf;AACD;;;;;;AAGH,eAAe,IAAIpB,WAAJ,EAAf","sourcesContent":["import auth0 from \"auth0-js\";\nimport authConfig from \"../auth_config.json\";\nimport eventBus from \"../event-bus\";\n\nconst webAuth = new auth0.WebAuth({\n  domain: authConfig.domain,\n  redirectUri: `${window.location.origin}/callback`,\n  clientID: authConfig.clientId,\n  audience: authConfig.audience,\n  responseType: \"token id_token\",\n  scope: \"openid profile email\"\n});\n\nclass AuthService {\n  accessToken = null;\n  idToken = null;\n  profile = null;\n  tokenExpiry = null;\n  // Starts the user login flow\n  login(customState) {\n    webAuth.authorize({\n      appState: customState\n    });\n  }\n  // Handles the callback request from Auth0\n  handleAuthentication() {\n    return new Promise((resolve, reject) => {\n      webAuth.parseHash((err, authResult) => {\n        if (err) {\n          reject(err);\n        } else {\n          this.localLogin(authResult);\n          resolve(authResult.idToken);\n        }\n      });\n    });\n  }\n  localLogin(authResult) {\n    this.idToken = authResult.idToken;\n    this.profile = authResult.idTokenPayload;\n    this.accessToken = authResult.accessToken;\n    // Convert the JWT expiry time from seconds to milliseconds\n    this.tokenExpiry = new Date(this.profile.exp * 1000);\n    localStorage.setItem(\"loggedIn\", \"true\");\n    eventBus.$emit(\"login\");\n  }\n}\n\nexport default new AuthService();"]}]}